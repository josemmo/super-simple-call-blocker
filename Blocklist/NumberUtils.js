let NumberUtils = (() => {

  const PREFIXES = [
    20, 27, 30, 31, 32, 33, 34, 36, 39, 40, 41, 43, 44, 45, 46, 47, 48, 49, 51,
    52, 53, 54, 55, 56, 57, 60, 61, 62, 63, 65, 66, 76, 77, 81, 86, 90, 91, 92,
    93, 94, 211, 212, 213, 216, 218, 220, 221, 222, 223, 224, 225, 226, 227,
    228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 240, 241, 244, 246,
    248, 249, 250, 251, 252, 253, 254, 256, 257, 258, 260, 261, 262, 263, 264,
    265, 266, 267, 268, 269, 291, 298, 299, 350, 351, 352, 353, 354, 355, 356,
    357, 358, 359, 370, 371, 372, 373, 374, 375, 376, 377, 378, 380, 381, 382,
    385, 386, 420, 421, 423, 501, 502, 503, 504, 505, 506, 507, 509, 590, 592,
    593, 594, 595, 596, 597, 598, 670, 673, 674, 675, 676, 677, 678, 679, 680,
    682, 683, 685, 686, 687, 688, 689, 690, 692, 852, 855, 880, 960, 961, 962,
    964, 965, 966, 967, 968, 971, 972, 973, 974, 975, 976, 977, 992, 993, 994,
    995, 996, 998, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210,
    1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1224, 1225, 1226, 1228,
    1231, 1236, 1240, 1242, 1246, 1248, 1250, 1252, 1253, 1254, 1256, 1264,
    1267, 1270, 1281, 1289, 1301, 1302, 1303, 1304, 1305, 1306, 1307, 1308,
    1309, 1310, 1312, 1313, 1314, 1315, 1316, 1317, 1318, 1319, 1320, 1321,
    1323, 1330, 1334, 1336, 1345, 1347, 1352, 1360, 1361, 1401, 1402, 1403,
    1404, 1405, 1406, 1407, 1408, 1409, 1410, 1412, 1413, 1414, 1415, 1416,
    1417, 1418, 1419, 1423, 1424, 1425, 1431, 1435, 1438, 1440, 1441, 1443,
    1450, 1469, 1473, 1480, 1484, 1501, 1502, 1503, 1504, 1505, 1506, 1507,
    1508, 1509, 1510, 1512, 1513, 1514, 1515, 1516, 1517, 1518, 1519, 1520,
    1530, 1540, 1541, 1559, 1561, 1562, 1570, 1571, 1573, 1580, 1581, 1587,
    1601, 1602, 1603, 1604, 1605, 1606, 1607, 1608, 1609, 1610, 1612, 1613,
    1614, 1615, 1616, 1617, 1618, 1619, 1623, 1626, 1630, 1636, 1646, 1647,
    1650, 1651, 1660, 1661, 1662, 1664, 1669, 1670, 1671, 1678, 1684, 1701,
    1702, 1703, 1704, 1705, 1706, 1707, 1708, 1709, 1712, 1713, 1714, 1715,
    1716, 1717, 1718, 1719, 1720, 1724, 1727, 1732, 1734, 1740, 1757, 1758,
    1760, 1765, 1767, 1770, 1773, 1775, 1778, 1781, 1785, 1786, 1801, 1802,
    1803, 1804, 1805, 1806, 1807, 1810, 1812, 1813, 1814, 1815, 1816, 1817,
    1818, 1819, 1828, 1830, 1831, 1832, 1843, 1847, 1849, 1850, 1856, 1858,
    1860, 1864, 1867, 1870, 1876, 1901, 1902, 1903, 1904, 1905, 1906, 1907,
    1908, 1909, 1910, 1912, 1913, 1914, 1915, 1916, 1917, 1918, 1919, 1920,
    1925, 1931, 1935, 1937, 1939, 1940, 1941, 1949, 1952, 1954, 1956, 1970,
    1972, 1973, 1978, 6723, 262269, 262639, 441481, 441534, 6189162, 6189164
  ];


  /**
   * To local
   *
   * Given a phone number, converts it to a local phone number by removing
   * country prefix.
   *
   * @param  string number Phone number
   * @return string        Local phone number
   */
  function toLocal(number) {
    // Normalize prefix
    if (number.indexOf('00') === 0) number = '+' + number.substring(2);
    if (number.indexOf('+') !== 0) return number;

    // Detect prefix
    for (let i in PREFIXES) {
      if (number.indexOf('+' + PREFIXES[i]) === 0) {
        return number.substring(PREFIXES[i].toString().length + 1);
      }
    }

    // Fallback
    return number.substring(1);
  }


  // Return functions
  return {toLocal: toLocal};

})();

module.exports = NumberUtils;
